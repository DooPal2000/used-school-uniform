<% layout('layouts/boilerplate')%>
    <div class="container mt-3">
        <div class="row justify-content-center">
            <div class="col-md-6 col-xl-4 d-flex justify-content-center align-items-center">
                <div class="card shadow mb-3">
                    <img src="https://images.unsplash.com/photo-1509822929063-6b6cfc9b42f2?q=80&w=2670&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"
                        alt="" class="card-img-top" />
                    <div class="card-body">
                        <h5 class="card-title">로그인</h5>
                        <form action="/login" method="POST" class="validated-form" novalidate>
                            <div class="mb-3">
                                <label class="form-label" for="phonenum">핸드폰 번호(-없이 번호만 입력)</label>
                                <input class="form-control" type="text" id="phonenum" name="phonenum" autofocus
                                    required>
                                <div class="valid-feedback">
                                    Looks good!
                                </div>
                            </div>

                            <div class="mb-3">
                                <label class="form-label" for="password">비밀번호</label>
                                <input class="form-control" type="password" id="password" name="password" required>
                                <div class="valid-feedback">
                                    Looks good!
                                </div>
                            </div>
                            <div class="d-flex justify-content-between">
                                <a href="/register" class="btn btn-dark">회원가입</a>
                                <button type="submit" class="btn btn-primary">로그인</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <% if(error && error.length) { %>
        <script>
            document.addEventListener('DOMContentLoaded', function () {
                Swal.fire({
                    icon: 'error',
                    title: '로그인 실패',
                    text: '로그인 도중 문제가 발생했습니다.'
                });
            });
        </script>
        <% } %>

    <script>
        const phoneInput = document.getElementById('phonenum');

        phoneInput.addEventListener('input', function (e) {
            let x = e.target.value.replace(/\D/g, '').match(/(\d{0,3})(\d{0,4})(\d{0,4})/);
            e.target.value = !x[2] ? x[1] : '010-' + x[2] + (x[3] ? '-' + x[3] : '');
        });

        // 폼 제출 시 하이픈 제거
        document.querySelector('form').addEventListener('submit', function (e) {
            phoneInput.value = phoneInput.value.replace(/-/g, '');
        });
    </script>